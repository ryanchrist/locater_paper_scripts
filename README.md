# Introduction
This repository provides instructions and scripts needed to replicate the simulations and figures found in our recent manuscript introducing `locater`, https://www.biorxiv.org/content/10.1101/2024.09.30.615852 . `locater` is an R package for testing tree structures (represented via a set of discrete clades and/or a relatedness matrix) for association with traits of interest. Installation instructions and source code for `locater` can be found here: https://github.com/ryanchrist/locater . Please see the package website, https://ryanchrist.github.io/locater/ , for documentation and an Article presenting toy example for getting started: https://ryanchrist.github.io/locater/articles/simple_gwas_example.html . This article also demonstrates how the `locater` package API may be used to test inferred clades and relatedness matrices generated by other ancestry inference methods.


# Installing dependencies for haplotype simulation

We use [msprime](https://tskit.dev/msprime/docs/stable/installation.html) to perform haplotype simulation. Our public docker image containing an installation of `msprime` and other python dependencies required to directly run our simulation scripts from `R` is available on DockerHub: https://hub.docker.com/repositories/rchrist7 . On a system with Docker installed, R can be launched in a interactive session under this image by running

```
docker run -it rchrist7/mini-shark /bin/bash R
```

# Replicating Paper Figures

All scripts required to run the simulations presented in our pre-print https://www.biorxiv.org/content/10.1101/2024.09.30.615852 are available within the `shark` sub-directory. All simulations were run using the IBM LSF job management system on an academic university cluster using a job submission template found in `shark/simulation/association_sims/ryan_run_locater_sim.sh`. That script can be used to call to any of the seven simulation R scripts in `shark/simulation/ryan_sims_parameters` described below.

- locater12.R was used to run our null simulations
- locater14.R was used to run our power simulations assuming all causal variants were observed and fell within a 10kb window
- locater15.R was used to run our power simulations assuming all causal variants were hidden and fell within a 10kb window
-argneedle14.R was used to re-run the power simulations assuming all causal variants fell within a 10kb window (observed or hidden) using ARG-NEEDLE rather than locater
- locater16.R was used to run our power simulations assuming all causal variants were observed and fell within a 100kb window
- locater17.R was used to run our power simulations assuming all causal variants were hidden and fell within a 100kb window
-argneedle16.R was used to re-run the power simulations assuming all causal variants fell within a 100kb window (observed or hidden) using ARG-NEEDLE rather than locater

The results of these scripts were then written to intermediary files (.rds files) which were then read into R and used to produce our paper figures using the corresponding visualization scripts found in `shark/simulation/association_sims/ryan_viz/`.
